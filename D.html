<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  D - 【iOS - Foundation】说了是村长
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="【iOS - Foundation】说了是村长" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">【iOS - Foundation】说了是村长</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; 【iOS - Foundation】说了是村长</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>D</label></li>

          
            <li><a title="NSDecimal" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSDecimal.html">NSDecimal</a></li>
          
            <li><a title="NSDecimalNumber" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSDecimalNumber.html">NSDecimalNumber</a></li>
          
            <li><a title="NSData" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSData.html">NSData</a></li>
          

      
        <li class="divider"></li>
        <li><label>N</label></li>

          
            <li><a title="NSNumber" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSNumber.html">NSNumber</a></li>
          
            <li><a title="NSNumberFormatter" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSNumberFormatter.html">NSNumberFormatter</a></li>
          

      
        <li class="divider"></li>
        <li><label>M</label></li>

          
            <li><a title="NSMutableData" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSMutableData.html">NSMutableData</a></li>
          

      
        <li class="divider"></li>
        <li><label>V</label></li>

          
            <li><a title="NSValue" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSValue.html">NSValue</a></li>
          

      
        <li class="divider"></li>
        <li><label>R</label></li>

          
            <li><a title="NSRange" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSRange.html">NSRange</a></li>
          

      
        <li class="divider"></li>
        <li><label>U</label></li>

          
            <li><a title="1.12 NSUUID" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSUUID.html">1.12 NSUUID</a></li>
          

      
        <li class="divider"></li>
        <li><label>准备中</label></li>

          
            <li><a title="1.9 NSURL  待" href="15138437158694.html">1.9 NSURL  待</a></li>
          
            <li><a title="1.10 NSURLComponents 待" href="15138437157106.html">1.10 NSURLComponents 待</a></li>
          
            <li><a title="1.11 NSURLQueryItem 待" href="15138437155644.html">1.11 NSURLQueryItem 待</a></li>
          
            <li><a title="2.1 NSString 待" href="15138436818502.html">2.1 NSString 待</a></li>
          
            <li><a title="NSScanner 待" href="15217730180026.html">NSScanner 待</a></li>
          
            <li><a title="Foundation.h 剩余总览" href="15217711190756.html">Foundation.h 剩余总览</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>D</span></li>
                        
                          <li><a title="NSDecimal" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSDecimal.html">NSDecimal</a></li>
                        
                          <li><a title="NSDecimalNumber" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSDecimalNumber.html">NSDecimalNumber</a></li>
                        
                          <li><a title="NSData" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSData.html">NSData</a></li>
                        

                    
                      <li class="side-title"><span>N</span></li>
                        
                          <li><a title="NSNumber" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSNumber.html">NSNumber</a></li>
                        
                          <li><a title="NSNumberFormatter" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSNumberFormatter.html">NSNumberFormatter</a></li>
                        

                    
                      <li class="side-title"><span>M</span></li>
                        
                          <li><a title="NSMutableData" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSMutableData.html">NSMutableData</a></li>
                        

                    
                      <li class="side-title"><span>V</span></li>
                        
                          <li><a title="NSValue" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSValue.html">NSValue</a></li>
                        

                    
                      <li class="side-title"><span>R</span></li>
                        
                          <li><a title="NSRange" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSRange.html">NSRange</a></li>
                        

                    
                      <li class="side-title"><span>U</span></li>
                        
                          <li><a title="1.12 NSUUID" href="%E3%80%90iOS%20-%20Foundation%E3%80%91NSUUID.html">1.12 NSUUID</a></li>
                        

                    
                      <li class="side-title"><span>准备中</span></li>
                        
                          <li><a title="1.9 NSURL  待" href="15138437158694.html">1.9 NSURL  待</a></li>
                        
                          <li><a title="1.10 NSURLComponents 待" href="15138437157106.html">1.10 NSURLComponents 待</a></li>
                        
                          <li><a title="1.11 NSURLQueryItem 待" href="15138437155644.html">1.11 NSURLQueryItem 待</a></li>
                        
                          <li><a title="2.1 NSString 待" href="15138436818502.html">2.1 NSString 待</a></li>
                        
                          <li><a title="NSScanner 待" href="15217730180026.html">NSScanner 待</a></li>
                        
                          <li><a title="Foundation.h 剩余总览" href="15217711190756.html">Foundation.h 剩余总览</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 


	
		<div class="markdown-body">
		<h1>NSDecimal</h1>

		<ul>
<li>
<a href="#toc_0">数据结构</a>
</li>
<li>
<a href="#toc_1">舍入</a>
</li>
<li>
<a href="#toc_2">操作</a>
</li>
<li>
<a href="#toc_3">计算</a>
</li>
</ul>


<blockquote>
<p>NSDecimal</p>
</blockquote>

<h3 id="toc_0">数据结构</h3>

<ul>
<li>真是难以理解，水平不够，下面只好用 NSDecimalNumber 来初始化 NSDecimal 简单使用以下 NSDecimal 的相关内容；</li>
</ul>

<pre><code>typedef struct {
    signed   int _exponent:8;
    unsigned int _length:4;     // length == 0 &amp;&amp; isNegative -&gt; NaN
    unsigned int _isNegative:1;
    unsigned int _isCompact:1;
    unsigned int _reserved:18;
    unsigned short _mantissa[NSDecimalMaxSize];
} NSDecimal;
</code></pre>

<h3 id="toc_1">舍入</h3>

<ul>
<li>NSRoundingMode 舍入规则</li>
</ul>

<pre><code>typedef NS_ENUM(NSUInteger, NSRoundingMode) {
    NSRoundPlain,   // Round up on a tie
    NSRoundDown,    // Always down == truncate
    NSRoundUp,      // Always up
    NSRoundBankers  // on a tie round so last digit is even
};
</code></pre>

<ul>
<li>举例数据</li>
</ul>

<pre><code>// Original
//    value 1.2  1.21  1.25  1.35  1.27 原始值 
// Plain    1.2  1.2   1.3   1.4   1.3  四舍五入
// Down     1.2  1.2   1.2   1.3   1.2  向下取整
// Up       1.2  1.3   1.3   1.4   1.3  向上取整
// Bankers  1.2  1.2   1.2   1.4   1.3  四舍六入五留双（大学学的是不是还给老师了）
</code></pre>

<ul>
<li>举例代码</li>
</ul>

<blockquote>
<p>void NSDecimalRound(NSDecimal *result, const NSDecimal *number, NSInteger scale, NSRoundingMode roundingMode);</p>
</blockquote>

<pre><code>    NSDecimalNumber *decimalNumber1 = [NSDecimalNumber decimalNumberWithString:@&quot;1.25&quot;];
    NSDecimal decimal1 = [decimalNumber1 decimalValue];
    
    NSDecimal resDecimal;
    NSDecimalRound(&amp;resDecimal, &amp;decimal1, 1, NSRoundBankers);// 结果，操作数，保留小数位数，舍入规则
    NSDecimalNumber *resDecimalNumber = [NSDecimalNumber decimalNumberWithDecimal:resDecimal];
    
    NSLog(@&quot;%@&quot;, resDecimalNumber);
</code></pre>

<h3 id="toc_2">操作</h3>

<ul>
<li>是否是个数</li>
</ul>

<pre><code>    BOOL isNotANumber = NSDecimalIsNotANumber(&amp;decimal);
</code></pre>

<ul>
<li>复制</li>
</ul>

<pre><code>    NSDecimal copyDecimal;
    NSDecimalCopy(&amp;copyDecimal, &amp;decimal);
</code></pre>

<ul>
<li>压缩：按文档说法，计算前先压缩，可以提高效率；</li>
</ul>

<pre><code>    NSDecimalCompact(&amp;decimal);
</code></pre>

<ul>
<li>描述</li>
</ul>

<pre><code>    NSString *decimalString = NSDecimalString(&amp;decimal, nil);
    NSLog(@&quot;%@&quot;, decimalString);
</code></pre>

<h3 id="toc_3">计算</h3>

<ul>
<li>NSCalculationError 计算结果</li>
</ul>

<pre><code>    NSCalculationNoError = 0,
    NSCalculationLossOfPrecision, // Result lost precision
    NSCalculationUnderflow,       // Result became 0
    NSCalculationOverflow,        // Result exceeds possible representation
    NSCalculationDivideByZero
</code></pre>

<ul>
<li>准备 2 个 Decimal，下面都用这 2 个（只好 DecimalNumber 来初始化了）</li>
</ul>

<pre><code>    NSDecimalNumber *decimalNumber2_3 = [NSDecimalNumber decimalNumberWithString:@&quot;2.3&quot;];
    NSDecimal decimal2_3 = [decimalNumber2_3 decimalValue];
    NSDecimalNumber *decimalNumber3_4 = [NSDecimalNumber decimalNumberWithString:@&quot;3.4&quot;];
    NSDecimal decimal3_4 = [decimalNumber3_4 decimalValue];

    NSDecimal resultDecimal;
</code></pre>

<ul>
<li>规则化，相同的数值有很多表示方法，此函数即为了统一格式；</li>
</ul>

<pre><code>    NSCalculationError normalizeError = NSDecimalNormalize(&amp;decimal2_3, &amp;decimal3_4, NSRoundBankers);
    if (normalizeError == NSCalculationNoError) {
        NSLog(@&quot;NSCalculationNoError&quot;);
    }
</code></pre>

<ul>
<li>decimalA + decimalB</li>
</ul>

<pre><code>    NSCalculationError addError = NSDecimalAdd(&amp;resultDecimal, &amp;decimal2_3, &amp;decimal3_4, NSRoundBankers);
    if (addError == NSCalculationNoError) {
        NSLog(@&quot;add:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>

<ul>
<li>decimalA - decimalB</li>
</ul>

<pre><code>    NSCalculationError subtractError = NSDecimalSubtract(&amp;resultDecimal, &amp;decimal2_3, &amp;decimal3_4, NSRoundBankers);
    if (subtractError == NSCalculationNoError) {
        NSLog(@&quot;subtract:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>

<ul>
<li>decimalA * decimalB</li>
</ul>

<pre><code>    NSCalculationError multiplyError = NSDecimalMultiply(&amp;resultDecimal, &amp;decimal2_3, &amp;decimal3_4, NSRoundBankers);
    if (multiplyError == NSCalculationNoError) {
        NSLog(@&quot;multiply:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>

<ul>
<li>decimalA / decimalB</li>
</ul>

<pre><code>    NSCalculationError divideError = NSDecimalDivide(&amp;resultDecimal, &amp;decimal2_3, &amp;decimal3_4, NSRoundBankers);
    if (divideError == NSCalculationNoError) {
        NSLog(@&quot;divide:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>

<ul>
<li>decimalA ^ uintB</li>
</ul>

<pre><code>    NSCalculationError powerError = NSDecimalPower(&amp;resultDecimal, &amp;decimal2_3, 2, NSRoundBankers);
    if (powerError == NSCalculationNoError) {
        NSLog(@&quot;power:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>

<ul>
<li>decimalA * 10 ^ shortB</li>
</ul>

<pre><code>    NSCalculationError power10Error = NSDecimalMultiplyByPowerOf10(&amp;resultDecimal, &amp;decimal2_3, 2, NSRoundBankers);
    if (power10Error == NSCalculationNoError) {
        NSLog(@&quot;power10:%@&quot;, NSDecimalString(&amp;resultDecimal,nil));
    }
</code></pre>


		</div>
	

 
	

 
	

  
  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
